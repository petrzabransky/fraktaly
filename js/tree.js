"use strict"; const treeCanvas = document.getElementById("tree-canvas"), treeContext = treeCanvas.getContext("2d"), treeAngel = document.getElementById("tree-angel"), treeLength = document.getElementById("tree-length"), treeRandom = document.getElementById("tree-random"), treeBtn = document.getElementById("tree-btn"); function treeDraw() { let w = treeCanvas.width, h = treeCanvas.height, ang = parseFloat(treeAngel.value), len = h / 4.5, kLen = parseFloat(treeLength.value) / 100, offset = 50; treeContext.clearRect(0, 0, w, h), treeContext.beginPath(), treeContext.moveTo(w / 2, h - 50), treeContext.lineTo(w / 2, h - len - 50), treeContext.strokeStyle = "#ffffff", treeContext.lineWidth = len / 10, treeContext.stroke(), treeALine(w / 2, h - len - 50, len * kLen, 180 - ang, 0), treeALine(w / 2, h - len - 50, len * kLen, 180 + ang, 0) } function treeALine(x, y, length, startAng, tol) { let xx, yy, xa, ya, ang = parseFloat(treeAngel.value), kLen = parseFloat(treeLength.value) / 100, random = parseFloat(treeRandom.value) / 100, rnd; rnd = Math.random() * (2 * random) - random + 1, startAng *= rnd, rnd = Math.random() * (2 * random) - random + 1, ang *= rnd, rnd = Math.random() * (2 * random) - random + 1, length *= rnd, xa = Math.sin(startAng * (3.14 / 180)), ya = Math.cos(startAng * (3.14 / 180)), xx = x + xa * length, yy = y + ya * length, treeContext.beginPath(), treeContext.moveTo(x, y), treeContext.lineTo(xx, yy), treeContext.strokeStyle = "#ffffff", treeContext.lineWidth = length / 10, treeContext.stroke(), length > 1 && (treeALine(xx, yy, length * kLen, startAng - ang, tol), treeALine(xx, yy, length * kLen, startAng + ang, tol)) } function setCanvasTree() { let w = document.getElementById("tree-canvas").parentElement.clientWidth, h = document.getElementById("tree-canvas").parentElement.clientWidth; treeCanvas.width = w - 75, treeCanvas.height = h - 75, treeDraw() } function setValueTree() { treeAngel.value = 30, treeLength.value = 68, treeRandom.value = 10 } setCanvasTree(), setValueTree(), treeAngel.oninput = function () { treeDraw() }, treeLength.oninput = function () { treeDraw() }, treeRandom.oninput = function () { treeDraw() }, treeBtn.onclick = function () { setValueTree(), treeDraw() };